/* LFInteractive LLC. All Rights Reserved */
async function register(e){let r=new FormData(e),t=await fetch("/assets/php/auth.php?c=staff&s=lfinteractive&m=register",{method:"POST",body:r});if(t.ok){let e=await t.json();return null==e.error?(await login(r.email,r.password,!1),{successful:!0,message:""}):{successful:!1,message:e.error}}return{successful:!0,message:""}}async function login(e,r,t){let o=new FormData;o.append("username",e),o.append("password",r);let s=await fetch("/assets/php/auth.php?c=staff&s=lfinteractive&m=login",{method:"POST",body:o});if(s.ok){let r=await s.json();if(null==r.error){let o=r.token;if(t){let r=new Date(3e3,0).toUTCString();document.cookie=`auth_username=${e};expires='${r}';path=/`,document.cookie=`auth_token=${o};expires='${r}'; path=/`}else document.cookie=`auth_username=${e}; path=/`,document.cookie=`auth_token=${o}; path=/`;return{successful:!0,message:""}}return{successful:!1,message:r.error}}}function Logout(){document.cookie=`auth_username=; expires=${new Date(2e3).toUTCString()};path=/`,document.cookie=`auth_token=; expires=${new Date(2e3).toUTCString()}; path=/`}(()=>{function e(){return $("input#password").val()!=$("input#confirm-password").val()?($("p.error").html("Passwords must match!"),$("input#password").addClass("error"),$("input#confirm-password").addClass("error"),!1):($("input#password").removeClass("error"),$("input#confirm-password").removeClass("error"),$("p.error").html(""),!0)}$("input[type=password]").attr("password",!0),$("toggle#show-password-toggle").click(e=>{$("input[password]").attr("type","true"!=$(e.target).attr("value")?"password":"text")}),$("form#staff-registration-form.form input#password").keyup(e),$("form#staff-registration-form.form input#confirm-password").keyup(e),$("form#staff-registration-form.form .btn.primary").click(async()=>{if($("p.error").html(""),e()){let e=await register($("form#staff-registration-form.form")[0]);e.successful?window.location.href="/staff-portal":$("p.error").html(e.message)}}),$("#login-form .btn.primary").click(async()=>{$("p.error").html(""),$("#login-form .btn.primary").attr("disabled","true");let e=$("#login-form input#username").val(),r=$("#login-form input#password").val(),t="true"==$("#login-form toggle#remember-me-toggle").attr("value"),o=await login(e,r,t);o.successful?window.location.href="/staff-portal":$("p.error").html(o.message),setTimeout(()=>{$("#login-form .btn.primary").attr("disabled",null)},2e3)})})();