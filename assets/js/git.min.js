/* LFInteractive LLC. All Rights Reserved */
async function GetDescription(){let e=await fetch(`https://api.github.com/repos/DcmanProductions/${page.model.name}/readme`),t=await e.json(),a=atob(t.content),n=(new showdown.Converter).makeHtml(a);$("#content")[0].innerHTML=n}async function Search(e){let t=new Headers;t.append("Authorization","token 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");let a=await fetch(`https://api.github.com/search/repositories?q=${encodeURI(e)}+user:dcmanproductions`,{method:"GET",headers:t,redirect:"follow"});GetItems((await a.json()).items)}async function GetItems(e=null){let t=`https://api.github.com/users/dcmanproductions/repos?per_page=${null==page.model.show?25:page.model.show}&page=${null==page.model.page?0:page.model.page}`,a=new Headers;if(a.append("Authorization","token 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"),null==e){let n=await fetch(t,{method:"GET",headers:a,redirect:"follow"});e=await n.json()}let n=$("#search-items")[0];n.innerHTML="",0==e.length&&(n.innerHTML='<h3 class="centered" style="width: 100%; text-align: center; margin-top: 100px;">No Items Found!</h3>');let o=["Jan","Feb","Mar","April","May","June","July","Aug","Sept","Oct","Nov","Dec"],s=["Sun","Mon","Tue","Wed","Thru","Fri","Sat"];Array.from(e).forEach(e=>{let t=new Date(e.updated_at),i=t.toLocaleTimeString(),r=o[t.getMonth()],l=s[t.getDay()],c=t.getFullYear();t=`${l}, ${r} ${t.getDate()}, ${c} - ${i}`;let d=e.name.replaceAll("-"," "),p=0,u=!1,h=`\n<div class="search-item row">\n    <div class="col content">\n        <p class="name" onclick="Navigate('projects', 'project', {name: '${e.name}'})">${d}</p>\n        <p class="last-updated">last updated: <span class="date">${t}</span></p>\n        <p class="description">${null==e.description?"No Description!":e.description}</p>\n    </div>\n            `;fetch(e.releases_url.replace("{/id}",""),{method:"GET",headers:a,redirect:"follow"}).then(e=>e.json()).then(e=>{e.length>0&&(u=!0,Array.from(e).forEach(e=>{Array.from(e.assets).forEach(e=>{p+=e.download_count})}))}).then(()=>{u&&(h+=`\n                    <div class="col extras">\n                        <div class="btn primary download">${p} <i class="fa fa-solid fa-download"></i></div>\n                        <div class="btn primary"><i class="fa fa-solid fa-book"></i></div>\n                    </div>`),h+="</div>",n.innerHTML+=h})})}document.addEventListener("nav-complete",()=>{"projects"==page.controller&&"index"==page.view?(null!=page.model.query?($(".input#search input")[0].value=decodeURI(page.model.query),Search(decodeURI(page.model.query))):GetItems(),$(".input#search input").on("keydown",e=>{if("Enter"==e.key){let t=e.target.value;""==t?GetItems():Search(t)}})):"home"==page.controller&&"index"==page.view?$(".input#search input").on("keydown",e=>{if("Enter"==e.key){let t=e.target.value;Navigate("projects","index",{show:100,query:t})}}):"projects"==page.controller&&"project"==page.view&&(null==page.model.section||"description"==page.model.section?($("#description")[0].classList.add("selected"),GetDescription()):"versions"==page.model.section?$("#versions")[0].classList.add("selected"):"documentation"==page.model.section&&$("#documentation")[0].classList.add("selected"))});